<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator - Free Online Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .tab.active {
            background: #4CAF50;
            color: white;
        }

        .tab-content {
            padding: 30px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .qr-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .qr-type-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }

        .qr-type-btn.active {
            border-color: #4CAF50;
            background: #4CAF50;
            color: white;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }

        .special-inputs {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #4CAF50;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary { background: #4CAF50; color: white; }
        .btn-secondary { background: #2196F3; color: white; }
        .btn-logo { background: #FF9800; color: white; }
        .btn-batch { background: #9C27B0; color: white; }

        .btn:hover {
            transform: translateY(-2px);
        }

        .qr-preview {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 20px;
        }

        #qrcode {
            display: inline-block;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .customization, .history, .debug, .about {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .color-picker, .logo-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .color-input input {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .history-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            padding: 10px;
            border-radius: 8px;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
        }

        .history-item:hover {
            background: #e0e0e0;
        }

        .debug-console {
            background: black;
            color: lightgreen;
            font-family: 'Consolas', monospace;
            padding: 10px;
            height: 200px;
            overflow-y: auto;
            border-radius: 8px;
        }

        .error-message {
            color: #d32f2f;
            background: #ffebee;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ QR Code Generator</h1>
            <p>Free & Open Source - Create custom QR codes instantly</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="generator">üéØ Generator</div>
            <div class="tab" data-tab="customize">üé® Customize</div>
            <div class="tab" data-tab="history">üìö History</div>
            <div class="tab" data-tab="debug">üêõ Debug</div>
            <div class="tab" data-tab="about">‚ÑπÔ∏è About</div>
        </div>

        <div class="tab-content active" id="generator">
            <div class="input-section">
                <div class="qr-type-selector">
                    <div class="qr-type-btn active" data-type="website">üåê Website</div>
                    <div class="qr-type-btn" data-type="email">üìß Email</div>
                    <div class="qr-type-btn" data-type="phone">üìû Phone</div>
                    <div class="qr-type-btn" data-type="wifi">üì∂ WiFi</div>
                    <div class="qr-type-btn" data-type="vcard">üë§ vCard</div>
                    <div class="qr-type-btn" data-type="text">üìù Text</div>
                </div>

                <div class="input-group">
                    <label for="mainInput">Content:</label>
                    <input type="text" id="mainInput" placeholder="Enter website, email, phone, or text..." value="https://github.com/komonaelliy">
                </div>

                <div id="wifiInputs" class="special-inputs hidden">
                    <div class="input-group">
                        <label for="wifiSSID">WiFi SSID:</label>
                        <input type="text" id="wifiSSID" placeholder="Enter your WiFi network name">
                    </div>
                    <div class="input-group">
                        <label for="wifiPassword">WiFi Password:</label>
                        <input type="text" id="wifiPassword" placeholder="Enter your WiFi password">
                    </div>
                </div>

                <div id="vcardInputs" class="special-inputs hidden">
                    <div class="input-group">
                        <label for="vcardName">Full Name:</label>
                        <input type="text" id="vcardName" placeholder="Enter full name">
                    </div>
                    <div class="input-group">
                        <label for="vcardPhone">Phone Number:</label>
                        <input type="text" id="vcardPhone" placeholder="Enter phone number">
                    </div>
                    <div class="input-group">
                        <label for="vcardEmail">Email Address:</label>
                        <input type="text" id="vcardEmail" placeholder="Enter email address">
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generateQRCode()">üöÄ Generate QR Code</button>
                    <button class="btn btn-secondary" onclick="downloadQRCode()" id="downloadBtn" disabled>üíæ Download</button>
                    <button class="btn btn-logo" onclick="chooseLogo()">üñºÔ∏è Add Logo</button>
                    <button class="btn btn-batch" onclick="batchGenerate()">üîÅ Batch Generate</button>
                </div>

                <div class="qr-preview">
                    <h3>QR Code Preview</h3>
                    <div id="qrcode">
                        <p style="color: #666;">QR code will appear here after generation</p>
                    </div>
                    <p id="qrInfo" style="margin-top: 15px; color: #666;"></p>
                    <div id="errorMessage" class="error-message hidden"></div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="customize">
            <div class="customization">
                <h3>üé® Customization</h3>
                <div class="color-picker">
                    <div class="color-input">
                        <label>QR Color:</label>
                        <input type="color" id="qrColor" value="#000000">
                    </div>
                    <div class="color-input">
                        <label>Background:</label>
                        <input type="color" id="bgColor" value="#ffffff">
                    </div>
                </div>
                <div class="logo-settings">
                    <div class="input-group">
                        <label>Logo Size (%):</label>
                        <input type="range" id="logoSize" min="10" max="40" value="25">
                    </div>
                    <div class="input-group">
                        <label>Logo:</label>
                        <input type="file" id="logoInput" accept="image/*">
                        <p id="logoStatus">No logo selected</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="history">
            <div class="history">
                <h3>üìö History</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="loadFromHistory()">Load Selected</button>
                    <button class="btn btn-secondary" onclick="clearHistory()">Clear History</button>
                </div>
                <div class="history-list" id="historyList"></div>
            </div>
        </div>

        <div class="tab-content" id="debug">
            <div class="debug">
                <h3>üêõ Debug Console</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="clearConsole()">Clear Console</button>
                    <button class="btn btn-secondary" onclick="testDomainDetection()">Test Domain Detection</button>
                </div>
                <div class="debug-console" id="debugConsole"></div>
            </div>
        </div>

        <div class="tab-content" id="about">
            <div class="about">
                <h3>‚ÑπÔ∏è About</h3>
                <p>
                    üöÄ Advanced QR Code Generator<br>
                    Version: 1.0.0<br>
                    License: MIT - Free and Open Source<br><br>
                    ‚ú® Features:<br>
                    ‚Ä¢ Multiple QR code types (Website, Email, Phone, WiFi, vCard, Text)<br>
                    ‚Ä¢ Custom colors and logo support<br>
                    ‚Ä¢ Batch QR code generation<br>
                    ‚Ä¢ History tracking<br>
                    ‚Ä¢ Real-time debugging<br><br>
                    üõ†Ô∏è Built With:<br>
                    ‚Ä¢ HTML, CSS, JavaScript<br>
                    ‚Ä¢ QRCode.js library<br><br>
                    üìñ How to Use:<br>
                    1. Select QR type in Generator tab<br>
                    2. Enter your content<br>
                    3. Customize appearance in Customize tab<br>
                    4. Generate and download your QR code!<br><br>
                    ü§ù Contributing:<br>
                    This is open source! Feel free to:<br>
                    ‚Ä¢ Report issues<br>
                    ‚Ä¢ Suggest features<br>
                    ‚Ä¢ Submit pull requests<br>
                    ‚Ä¢ Share with others<br><br>
                    üìÑ License:<br>
                    MIT License - Free to use, modify, and distribute<br><br>
                    Developed with ‚ù§Ô∏è for the community
                </p>
                <button class="btn btn-primary" onclick="window.open('https://github.com/komonaelliy/online-qr-generator')">‚≠ê Star on GitHub</button>
            </div>
        </div>

        <div class="footer">
            <p>Made with ‚ù§Ô∏è by komonaelliy | Free & Open Source</p>
            <p>‚≠ê Star this project on <a href="https://github.com/komonaelliy/online-qr-generator" target="_blank">GitHub</a></p>
        </div>
    </div>

    <script>
        let currentQRType = 'website';
        let currentQRCode = null;
        let logoImage = null;
        let history = [];

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                document.getElementById(this.dataset.tab).classList.add('active');
            });
        });

        // QR type selection
        document.querySelectorAll('.qr-type-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.qr-type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentQRType = this.dataset.type;
                showSpecialInputs();
            });
        });

        // Show/hide special inputs
        function showSpecialInputs() {
            document.getElementById('wifiInputs').classList.add('hidden');
            document.getElementById('vcardInputs').classList.add('hidden');
            document.getElementById('errorMessage').classList.add('hidden');
            document.getElementById('mainInput').style.display = 'block';

            if (currentQRType === 'wifi') {
                document.getElementById('wifiInputs').classList.remove('hidden');
                document.getElementById('mainInput').style.display = 'none';
            } else if (currentQRType === 'vcard') {
                document.getElementById('vcardInputs').classList.remove('hidden');
                document.getElementById('mainInput').style.display = 'none';
            }
        }

        // Domain detection
        function detectInputType(userInput) {
            userInput = userInput.trim();
            const domainPattern = /^[a-zA-Z0-9][a-zA-Z0-9.-]*\.[a-zA-Z]{2,}$/;
            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            const phonePattern = /^[\+]?[0-9\s\-\(\)]{10,}$/;

            if (domainPattern.test(userInput) && !userInput.includes(' ')) {
                return { data: `https://${userInput}`, type: 'website' };
            }
            if (userInput.startsWith('http://') || userInput.startsWith('https://')) {
                return { data: userInput, type: 'website' };
            }
            if (userInput.startsWith('www.')) {
                return { data: `https://${userInput}`, type: 'website' };
            }
            if (emailPattern.test(userInput)) {
                return { data: `mailto:${userInput}`, type: 'email' };
            }
            if (phonePattern.test(userInput)) {
                const cleanPhone = userInput.replace(/[\s\-\(\)]/g, '');
                return { data: `tel:${cleanPhone}`, type: 'phone' };
            }
            if (userInput.startsWith('@')) {
                return { data: `https://instagram.com/${userInput.slice(1)}`, type: 'social media' };
            }
            return { data: userInput, type: 'text' };
        }

        // Generate QR code
        function generateQRCode() {
            const qrColor = document.getElementById('qrColor').value;
            const bgColor = document.getElementById('bgColor').value;
            let qrData = '';
            let qrInfo = '';

            document.getElementById('errorMessage').classList.add('hidden');

            try {
                switch (currentQRType) {
                    case 'website':
                    case 'email':
                    case 'phone':
                    case 'text':
                        const input = document.getElementById('mainInput').value.trim();
                        if (!input) throw new Error('Please enter content');
                        const { data, type } = detectInputType(input);
                        qrData = data;
                        qrInfo = `${type}: ${data.substring(0, 60)}${data.length > 60 ? '...' : ''}`;
                        break;

                    case 'wifi':
                        const ssid = document.getElementById('wifiSSID').value.trim();
                        const password = document.getElementById('wifiPassword').value.trim();
                        if (!ssid) throw new Error('Enter WiFi SSID');
                        qrData = `WIFI:S:${ssid};T:WPA;P:${password};;`;
                        qrInfo = `WiFi: ${ssid}`;
                        break;

                    case 'vcard':
                        const name = document.getElementById('vcardName').value.trim();
                        const vcardPhone = document.getElementById('vcardPhone').value.trim();
                        const vcardEmail = document.getElementById('vcardEmail').value.trim();
                        if (!name) throw new Error('Enter name for vCard');
                        qrData = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nTEL:${vcardPhone}\nEMAIL:${vcardEmail}\nEND:VCARD`;
                        qrInfo = `vCard: ${name}`;
                        break;
                }

                const qr = qrcode(0, 'H');
                qr.addData(qrData);
                qr.make();

                // Create a canvas to render the QR code
                const boxSize = 10;
                const moduleCount = qr.getModuleCount();
                const size = moduleCount * boxSize;
                const canvas = document.createElement('canvas');
                canvas.width = size;
                canvas.height = size;
                const ctx = canvas.getContext('2d');

                // Fill background
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, size, size);

                // Draw QR code
                for (let row = 0; row < moduleCount; row++) {
                    for (let col = 0; col < moduleCount; col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillStyle = qrColor;
                            ctx.fillRect(col * boxSize, row * boxSize, boxSize, boxSize);
                        }
                    }
                }

                // Add logo if selected
                if (logoImage && document.getElementById('logoSize').value > 0) {
                    const logoSizePercent = document.getElementById('logoSize').value;
                    const logoSize = size * (logoSizePercent / 100);
                    const logo = new Image();
                    logo.src = logoImage;
                    logo.onload = () => {
                        ctx.save();
                        ctx.beginPath();
                        const centerX = size / 2;
                        const centerY = size / 2;
                        const radius = logoSize / 2;
                        ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                        ctx.clip();
                        ctx.drawImage(logo, centerX - radius, centerY - radius, logoSize, logoSize);
                        ctx.restore();
                        document.getElementById('qrcode').innerHTML = '';
                        document.getElementById('qrcode').appendChild(canvas);
                    };
                } else {
                    document.getElementById('qrcode').innerHTML = '';
                    document.getElementById('qrcode').appendChild(canvas);
                }

                document.getElementById('qrInfo').textContent = qrInfo;
                document.getElementById('downloadBtn').disabled = false;

                currentQRCode = { data: qrData, color: qrColor, bgColor: bgColor, element: canvas };
                saveToHistory(qrData, currentQRType);

                logToConsole(`‚úì Generated ${currentQRType} QR code: ${qrInfo}`);
            } catch (error) {
                document.getElementById('errorMessage').textContent = error.message;
                document.getElementById('errorMessage').classList.remove('hidden');
                logToConsole(`‚úó Error: ${error.message}`);
            }
        }

        // Logo selection
        function chooseLogo() {
            const input = document.getElementById('logoInput');
            input.click();
            input.onchange = () => {
                const file = input.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        logoImage = e.target.result;
                        document.getElementById('logoStatus').textContent = `Logo: ${file.name}`;
                        document.getElementById('logoStatus').style.color = 'green';
                        generateQRCode(); // Regenerate with logo
                    };
                    reader.readAsDataURL(file);
                }
            };
        }

        // Batch generation
        function batchGenerate() {
            const input = prompt('Enter multiple items (one per line):');
            if (!input) return;

            const items = input.split('\n').map(item => item.trim()).filter(item => item);
            const zip = new JSZip();

            items.forEach((item, index) => {
                const { data } = detectInputType(item);
                const qr = qrcode(0, 'H');
                qr.addData(data);
                qr.make();
                const boxSize = 10;
                const moduleCount = qr.getModuleCount();
                const size = moduleCount * boxSize;
                const canvas = document.createElement('canvas');
                canvas.width = size;
                canvas.height = size;
                const ctx = canvas.getContext('2d');
                ctx.fillStyle = document.getElementById('bgColor').value;
                ctx.fillRect(0, 0, size, size);
                for (let row = 0; row < moduleCount; row++) {
                    for (let col = 0; col < moduleCount; col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillStyle = document.getElementById('qrColor').value;
                            ctx.fillRect(col * boxSize, row * boxSize, boxSize, boxSize);
                        }
                    }
                }
                const dataUrl = canvas.toDataURL('image/png');
                zip.file(`qr_batch_${index + 1}.png`, dataUrl.split(',')[1], { base64: true });
            });

            zip.generateAsync({ type: 'blob' }).then(blob => {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'qr_codes.zip';
                link.click();
                logToConsole(`‚úì Generated ${items.length} QR codes in batch`);
            });
        }

        // History management
        function saveToHistory(data, type) {
            history.unshift({ data, type, timestamp: new Date().toISOString() });
            history = history.slice(0, 10);
            localStorage.setItem('qrHistory', JSON.stringify(history));
            refreshHistory();
        }

        function loadHistory() {
            const saved = localStorage.getItem('qrHistory');
            if (saved) history = JSON.parse(saved);
            refreshHistory();
        }

        function refreshHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = '';
            history.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.textContent = `${index + 1}. ${item.type}: ${item.data.substring(0, 40)}...`;
                div.onclick = () => {
                    document.getElementById('mainInput').value = item.data;
                    document.querySelector(`.qr-type-btn[data-type="${item.type}"]`)?.click();
                    document.querySelector('.tab[data-tab="generator"]').click();
                    generateQRCode();
                };
                list.appendChild(div);
            });
        }

        function loadFromHistory() {
            const selected = document.querySelector('.history-item:hover');
            if (selected) selected.click();
        }

        function clearHistory() {
            history = [];
            localStorage.removeItem('qrHistory');
            refreshHistory();
            logToConsole('‚úì History cleared');
        }

        // Debug console
        function logToConsole(message) {
            const console = document.getElementById('debugConsole');
            console.innerHTML += `${new Date().toLocaleString()} - ${message}<br>`;
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('debugConsole').innerHTML = '';
        }

        function testDomainDetection() {
            const tests = ['playerkomona.top', 'google.com', 'test@example.com', '+1234567890', '@username'];
            logToConsole('=== DOMAIN DETECTION TEST ===');
            tests.forEach(test => {
                const { data, type } = detectInputType(test);
                logToConsole(`"${test}" -> ${type}: ${data}`);
            });
        }

        // Download QR code
        function downloadQRCode() {
            if (!currentQRCode || !currentQRCode.element) {
                alert('Please generate a QR code first');
                return;
            }
            const link = document.createElement('a');
            link.download = currentQRCode.data.startsWith('http') ? `qrcode_${currentQRCode.data.split('/')[2]}.png` : 'qrcode.png';
            link.href = currentQRCode.element.toDataURL('image/png');
            link.click();
        }

        // Initialize
        loadHistory();
        window.addEventListener('load', generateQRCode);
        document.getElementById('mainInput').addEventListener('keypress', e => e.key === 'Enter' && generateQRCode());
        document.getElementById('wifiSSID')?.addEventListener('keypress', e => e.key === 'Enter' && generateQRCode());
        document.getElementById('wifiPassword')?.addEventListener('keypress', e => e.key === 'Enter' && generateQRCode());
        document.getElementById('vcardName')?.addEventListener('keypress', e => e.key === 'Enter' && generateQRCode());
    </script>
</body>
</html>
