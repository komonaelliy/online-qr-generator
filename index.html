<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NM QR Generator</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 0;
    color: #333;
    text-align: center;
  }
  header {
    background: #0078d7;
    color: white;
    padding: 1rem;
    font-size: 1.5rem;
    font-weight: bold;
  }
  .container {
    margin: 2rem auto;
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    width: 95%;
    max-width: 500px;
  }
  .type-selector button {
    margin: 0.3rem;
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 6px;
    background: #eee;
    cursor: pointer;
  }
  .type-selector button.active {
    background: #0078d7;
    color: white;
  }
  .input-group {
    margin: 1rem 0;
  }
  input {
    padding: 0.5rem;
    width: 90%;
    max-width: 400px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
  label {
    display: block;
    margin-top: 0.5rem;
  }
  .color-picker {
    margin: 1rem 0;
  }
  .btn {
    background: #0078d7;
    color: white;
    border: none;
    padding: 0.7rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
  }
  .btn:disabled {
    background: #aaa;
    cursor: not-allowed;
  }
  canvas {
    margin-top: 1.5rem;
  }
  #errorMessage {
    color: red;
    margin-top: 1rem;
    display: none;
  }
</style>
</head>
<body>
<header>NM QR Code Generator</header>

<div class="container">
  <div class="type-selector">
    <button onclick="setQRType('website')" class="active">Website</button>
    <button onclick="setQRType('email')">Email</button>
    <button onclick="setQRType('phone')">Phone</button>
    <button onclick="setQRType('wifi')">WiFi</button>
    <button onclick="setQRType('vcard')">vCard</button>
    <button onclick="setQRType('text')">Text</button>
  </div>

  <div id="inputFields"></div>

  <div class="color-picker">
    <label>QR Color: <input type="color" id="qrColor" value="#000000"></label>
    <label>Background Color: <input type="color" id="bgColor" value="#ffffff"></label>
  </div>

  <button class="btn" onclick="generateQRCode()">Generate QR</button>
  <button id="downloadBtn" class="btn" onclick="downloadQR()" disabled>Download</button>

  <div id="errorMessage"></div>

  <div id="qrcode"></div>
  <div id="qrInfo"></div>
</div>

<!-- QR Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

<script>
let currentQRType = 'website';
let currentQRCode = null;

function setQRType(type) {
  currentQRType = type;
  document.querySelectorAll('.type-selector button').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`button[onclick="setQRType('${type}')"]`).classList.add('active');

  const container = document.getElementById('inputFields');
  container.innerHTML = '';

  switch(type) {
    case 'website':
      container.innerHTML = `<input id="mainInput" placeholder="Enter website URL (e.g. https://example.com)">`;
      break;
    case 'email':
      container.innerHTML = `<input id="mainInput" placeholder="Enter email address">`;
      break;
    case 'phone':
      container.innerHTML = `<input id="mainInput" placeholder="Enter phone number">`;
      break;
    case 'wifi':
      container.innerHTML = `
        <input id="wifiSSID" placeholder="WiFi SSID">
        <input id="wifiPassword" placeholder="WiFi Password">`;
      break;
    case 'vcard':
      container.innerHTML = `
        <input id="vcardName" placeholder="Full Name">
        <input id="vcardPhone" placeholder="Phone Number">
        <input id="vcardEmail" placeholder="Email Address">`;
      break;
    case 'text':
      container.innerHTML = `<input id="mainInput" placeholder="Enter any text">`;
      break;
  }
}

function generateQRCode() {
  const qrColor = document.getElementById('qrColor').value;
  const bgColor = document.getElementById('bgColor').value;
  let qrData = '';
  let qrInfo = '';

  const errorMessage = document.getElementById('errorMessage');
  errorMessage.style.display = 'none';

  try {
    switch(currentQRType) {
      case 'website':
        let website = document.getElementById('mainInput').value.trim();
        if (!website) throw new Error('Please enter a website URL');
        if (!website.startsWith('http')) website = 'https://' + website;
        qrData = website;
        qrInfo = `Website: ${website}`;
        break;

      case 'email':
        const email = document.getElementById('mainInput').value.trim();
        if (!email || !email.includes('@')) throw new Error('Invalid email address');
        qrData = `mailto:${email}`;
        qrInfo = `Email: ${email}`;
        break;

      case 'phone':
        const phone = document.getElementById('mainInput').value.trim();
        if (!phone) throw new Error('Please enter a phone number');
        qrData = `tel:${phone}`;
        qrInfo = `Phone: ${phone}`;
        break;

      case 'wifi':
        const ssid = document.getElementById('wifiSSID').value.trim();
        const password = document.getElementById('wifiPassword').value.trim();
        if (!ssid) throw new Error('Please enter WiFi SSID');
        qrData = `WIFI:S:${ssid};T:WPA;P:${password};;`;
        qrInfo = `WiFi: ${ssid}`;
        break;

      case 'vcard':
        const name = document.getElementById('vcardName').value.trim();
        const vPhone = document.getElementById('vcardPhone').value.trim();
        const vEmail = document.getElementById('vcardEmail').value.trim();
        if (!name) throw new Error('Please enter name for vCard');
        qrData = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nTEL:${vPhone}\nEMAIL:${vEmail}\nEND:VCARD`;
        qrInfo = `vCard: ${name}`;
        break;

      case 'text':
        qrData = document.getElementById('mainInput').value.trim();
        if (!qrData) throw new Error('Please enter some text');
        qrInfo = `Text: ${qrData.substring(0, 50)}${qrData.length > 50 ? '...' : ''}`;
        break;
    }

    const qr = qrcode(0, 'H');
    qr.addData(qrData);
    qr.make();

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const count = qr.getModuleCount();
    const tileSize = 8;
    canvas.width = canvas.height = count * tileSize;

    ctx.fillStyle = bgColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    for (let r = 0; r < count; r++) {
      for (let c = 0; c < count; c++) {
        ctx.fillStyle = qr.isDark(r, c) ? qrColor : bgColor;
        ctx.fillRect(c * tileSize, r * tileSize, tileSize, tileSize);
      }
    }

    const qrContainer = document.getElementById('qrcode');
    qrContainer.innerHTML = '';
    qrContainer.appendChild(canvas);
    document.getElementById('qrInfo').textContent = qrInfo;

    document.getElementById('downloadBtn').disabled = false;
    currentQRCode = { element: canvas };

  } catch (err) {
    errorMessage.textContent = err.message;
    errorMessage.style.display = 'block';
  }
}

function downloadQR() {
  if (!currentQRCode) return;
  const link = document.createElement('a');
  link.download = 'nm_qrcode.png';
  link.href = currentQRCode.element.toDataURL('image/png');
  link.click();
}
</script>
</body>
</html>
